# PDF 下載功能測試清單

## 🧪 測試前準備

### 檢查依賴包
確認已安裝必要的依賴包：

```bash
# 檢查 package.json
cat package.json | grep -E "html2canvas|jspdf"

# 應該看到：
# "html2canvas": "^1.4.1",
# "jspdf": "^2.5.1"
```

如果沒有安裝：
```bash
npm install html2canvas jspdf
```

### 確認開發服務器運行
```bash
npm run dev
```

## ✅ 測試步驟

### 測試 1: 基本功能測試

#### 1.1 生成報告
- [ ] 填寫職缺資訊
- [ ] 上傳履歷
- [ ] 點擊「啟動 AI 戰略分析」
- [ ] 等待報告生成完成

#### 1.2 查看下載按鈕
- [ ] 確認右上角顯示「下載 PDF 報告」按鈕
- [ ] 按鈕樣式正確（藍色背景、白色文字）
- [ ] 懸停時有放大效果

#### 1.3 下載 PDF
- [ ] 點擊「下載 PDF 報告」按鈕
- [ ] 按鈕變為「生成 PDF 中...」並顯示旋轉圖標
- [ ] 按鈕變灰且不可點擊
- [ ] 3-10 秒後 PDF 自動下載
- [ ] 按鈕恢復為「下載 PDF 報告」

#### 1.4 檢查下載的 PDF
- [ ] PDF 文件名格式正確：`JobBeagle_[職位名稱]_[日期].pdf`
- [ ] 文件大小合理（1-3 MB）
- [ ] 可以用 PDF 閱讀器打開

### 測試 2: 內容質量測試

#### 2.1 深色背景
- [ ] PDF 保留深色背景（#020617）
- [ ] 背景顏色均勻，無白色區域
- [ ] 邊緣沒有白邊

#### 2.2 文字清晰度
- [ ] 標題清晰可讀
- [ ] 正文文字清晰可讀
- [ ] 小字（如時間戳）清晰可讀
- [ ] 沒有模糊或鋸齒

#### 2.3 圖表和圖標
- [ ] 匹配度圓環圖完整顯示
- [ ] 圓環圖顏色正確（綠/黃/紅）
- [ ] 所有圖標清晰顯示
- [ ] 圖標顏色正確保留

#### 2.4 排版一致性
- [ ] 標題對齊正確
- [ ] 段落間距正確
- [ ] 列表縮進正確
- [ ] 卡片邊框和圓角正確

#### 2.5 顏色保真度
- [ ] 主要文字顏色正確（slate-200）
- [ ] 次要文字顏色正確（slate-300）
- [ ] 強調色正確（黃色、綠色、藍色等）
- [ ] 背景色正確（slate-800, slate-900）

### 測試 3: 分頁測試

#### 3.1 單頁報告
- [ ] 短報告在一頁內完整顯示
- [ ] 無空白頁
- [ ] 底部無截斷

#### 3.2 多頁報告
- [ ] 長報告自動分頁
- [ ] 每頁銜接流暢
- [ ] 無內容重複
- [ ] 無內容丟失

### 測試 4: 異常情況測試

#### 4.1 快速點擊
- [ ] 連續快速點擊下載按鈕
- [ ] 只觸發一次下載
- [ ] 按鈕正確禁用

#### 4.2 下載過程中刷新
- [ ] 下載過程中刷新頁面
- [ ] 沒有產生錯誤
- [ ] 可以重新下載

#### 4.3 報告數據不完整
- [ ] 測試沒有基本分析的情況
- [ ] 顯示錯誤提示：「報告數據不完整，無法下載」
- [ ] 不觸發下載

### 測試 5: 瀏覽器兼容性測試

#### 5.1 Chrome/Edge
- [ ] 下載功能正常
- [ ] PDF 質量最佳
- [ ] 無控制台錯誤

#### 5.2 Firefox
- [ ] 下載功能正常
- [ ] PDF 質量良好
- [ ] 無控制台錯誤

#### 5.3 Safari
- [ ] 下載功能正常
- [ ] PDF 質量良好
- [ ] 無控制台錯誤

### 測試 6: 控制台日誌測試

#### 6.1 成功下載
應該看到以下日誌（按順序）：
```
📄 [PDF] 開始生成 PDF...
✅ [PDF] Canvas 生成成功
✅ [PDF] PDF 生成成功
✅ [PDF] 下載完成: JobBeagle_xxx_20260118.pdf
```

#### 6.2 下載失敗
應該看到錯誤日誌：
```
❌ [PDF] 下載報告時發生錯誤: [錯誤詳情]
```

### 測試 7: 性能測試

#### 7.1 短報告（1-2 頁）
- [ ] 生成時間 < 5 秒
- [ ] 文件大小 < 1 MB
- [ ] 無明顯卡頓

#### 7.2 中等報告（3-5 頁）
- [ ] 生成時間 < 10 秒
- [ ] 文件大小 1-2 MB
- [ ] 無明顯卡頓

#### 7.3 長報告（6+ 頁）
- [ ] 生成時間 < 15 秒
- [ ] 文件大小 2-3 MB
- [ ] 可能有短暫卡頓但可接受

## 🐛 常見問題排查

### 問題 1: 下載按鈕無反應
**排查步驟：**
1. 打開控制台（F12）查看錯誤
2. 確認 html2canvas 和 jspdf 已安裝
3. 確認報告數據完整
4. 刷新頁面重試

### 問題 2: PDF 全白/全黑
**排查步驟：**
1. 檢查 `backgroundColor: '#020617'` 設置
2. 確認 CSS 樣式正確加載
3. 嘗試不同瀏覽器

### 問題 3: PDF 中文字模糊
**排查步驟：**
1. 確認 `scale: 2` 設置
2. 確認圖像質量為 1.0
3. 檢查瀏覽器縮放是否為 100%

### 問題 4: 圖表不顯示
**排查步驟：**
1. 等待圖表完全加載後再下載
2. 確認 `useCORS: true` 設置
3. 檢查網絡連接

### 問題 5: 文件太大
**排查步驟：**
1. 確認 `compress: true` 設置
2. 報告過長是正常現象
3. 考慮優化圖像質量

## 📊 測試結果記錄

### 測試環境
- **日期**: _______________
- **瀏覽器**: _______________
- **操作系統**: _______________
- **Node 版本**: _______________

### 測試結果
- [ ] 所有基本功能測試通過
- [ ] 所有內容質量測試通過
- [ ] 所有分頁測試通過
- [ ] 所有異常情況測試通過
- [ ] 所有瀏覽器兼容性測試通過
- [ ] 所有控制台日誌正確
- [ ] 所有性能測試通過

### 發現的問題
1. _______________________________________________
2. _______________________________________________
3. _______________________________________________

### 備註
___________________________________________________
___________________________________________________
___________________________________________________

## ✅ 驗收標準

功能可以上線需要滿足：
- [x] 基本下載功能正常工作
- [x] PDF 保留深色背景
- [x] PDF 保留所有顏色
- [x] PDF 排版與網頁一致
- [x] 文字清晰可讀
- [x] 圖表清晰可見
- [x] 自動分頁正常
- [x] 下載過程有進度提示
- [x] 主流瀏覽器兼容
- [x] 無明顯性能問題
- [x] 錯誤處理完善

## 🚀 快速測試命令

```bash
# 1. 安裝依賴
npm install

# 2. 啟動開發服務器
npm run dev

# 3. 打開瀏覽器
open http://localhost:3000

# 4. 生成報告並測試下載
```

## 📝 測試小技巧

1. **使用不同長度的報告測試** - 短、中、長報告
2. **測試不同的職位名稱** - 英文、中文、特殊字符
3. **在不同時段測試** - 確保性能穩定
4. **保留測試 PDF** - 用於對比和回歸測試
5. **記錄生成時間** - 監控性能變化

## 🎯 成功標準

✅ **優秀**
- 所有測試 100% 通過
- 生成時間 < 5 秒
- PDF 質量完美
- 無任何錯誤

✅ **良好**
- 核心測試通過
- 生成時間 < 10 秒
- PDF 質量良好
- 只有小問題

⚠️ **需改進**
- 部分測試失敗
- 生成時間 > 10 秒
- PDF 質量一般
- 有明顯問題
